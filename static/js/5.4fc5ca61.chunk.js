(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{384:function(t,e,n){"use strict";var a=n(3),r=n.n(a),i=n(61),o=n(415),s=n(32),c=n(108),l=n(74),d=n(24),u=n(60),g=n(960),p=function(t){return function(e,n){var a=n.handleClick;return r.a.createElement(o.a,{key:"SCENARIO_SELECT_VALUE_".concat(e.id),text:e.name,active:e.id===t.id,onClick:a})}};e.a=Object(i.b)(function(t){return{scenarios:t.model.programmes[0].scenarios}},null)(function(t){var e=t.scenarios,n=t.active,a=t.handleChange;return r.a.createElement("div",null,r.a.createElement(g.a,{items:e,itemRenderer:p(n),onItemSelect:function(t){return a(t)},onActiveItemChange:function(t){return a(t)},activeItem:n,popoverProps:{position:s.a.RIGHT_BOTTOM},filterable:!1},r.a.createElement("div",{style:{display:"inline-block",marginLeft:"7px",marginRight:"10px"}},"Select Scenario:"),r.a.createElement(c.a,{style:{width:"130px"}},r.a.createElement(l.b,{fill:!0,small:!0,intent:d.a.PRIMARY,rightIcon:"caret-down",alignText:u.a.LEFT,text:n.name}))))})},954:function(t,e,n){},968:function(t,e,n){"use strict";n.r(e);var a=n(38),r=n(102),i=n(41),o=n(34),s=n(105),c=n(39),l=n(3),d=n.n(l),u=n(61),g=n(939),p=n(5),h=n.n(p),f=n(0),m=function(t){switch(t){case f.gc:return 1;case f.fc:return 3;case f.ec:return 0;case f.dc:return 2;default:throw new Error("Unrecognised phase link type when populating gantt chart")}};function k(t,e){var n=t.model.programmes[0].scenarios.find(function(t){return t.id===e});if(!n)throw new Error("Could not find scenario");var a=t.model.programmes[0].phases,r=n.phaseSensitivity,i=t.model.programmes[0].phaseLinks;return{data:a.map(function(t){var e=r.find(function(e){return e.id===t.id}),n=e||t;return{id:t.id,text:t.name,start_date:h()(n.start,f.V).format(f.kb),duration:n.duration}}),links:i.map(function(t){return{id:t.id,type:m(t.type),source:t.sourceId,target:t.targetId}})}}var v=n(2),_=n(15),b=n(4);var y=n(24),w=n(31),E=(n(952),n(953),n(954),function(t){function e(t){var n;return Object(a.a)(this,e),(n=Object(i.a)(this,Object(o.a)(e).call(this,t))).state={dark:!1,reinitialise:!1},n}return Object(c.a)(e,t),Object(r.a)(e,[{key:"setZoom",value:function(t){switch(t){case"Weeks":gantt.config.min_column_width=70,gantt.config.scale_unit="month",gantt.config.date_scale="%F %Y",gantt.config.scale_height=60,gantt.config.subscales=[{unit:"week",step:1,date:"Week #%W"}],gantt.config.step=1,gantt.templates.date_scale=function(t){return gantt.date.date_to_str(gantt.config.date_scale)(t)};break;case"Months":gantt.config.min_column_width=70,gantt.config.scale_unit="year",gantt.config.date_scale="%Y",gantt.config.subscales=[{unit:"month",step:1,date:"%F"}],gantt.config.scale_height=60,gantt.config.step=1,gantt.templates.date_scale=function(t){return gantt.date.date_to_str(gantt.config.date_scale)(t)};break;case"Quarters":gantt.config.min_column_width=70,gantt.config.scale_unit="year",gantt.config.date_scale="%Y",gantt.config.step=1,gantt.templates.date_scale=function(t){return gantt.date.date_to_str(gantt.config.date_scale)(t)},gantt.config.subscales=[{unit:"quarter",step:1,template:function(t){var e=t.getMonth();return"Q"+(e>=9?4:e>=6?3:e>=3?2:1)}}],gantt.config.scale_height=60;break;case"Years":gantt.config.min_column_width=70,gantt.config.scale_unit="year",gantt.config.date_scale="%Y",gantt.config.step=10,gantt.config.subscales=[{unit:"year",step:1,date:"%Y"}],gantt.config.scale_height=60,gantt.templates.date_scale=function(t){var e=h()(t).year()%10,n=h()(t).subtract(e,"years").year(),a=h()(t).add(9-e,"years").year();return"".concat(n,"-").concat(a)}}}},{key:"shouldComponentUpdate",value:function(t){var e=this.props.tasks!==t.tasks,n=this.props.zoom!==t.zoom,a=this.props.size!==t.size,r=this.props.dark!==t.dark;return e||n||a||r}},{key:"componentDidUpdate",value:function(){if(gantt.clearAll(),this.state.reinitialise){var t=this.props.dark?"gantt_container darkGantt":"gantt_container";gantt.config.layout={css:t,rows:[{cols:[{view:"grid",id:"grid",scrollX:"scrollHor",scrollY:"scrollVer"},{view:"timeline",id:"timeline",scrollX:"scrollHor",scrollY:"scrollVer"},{view:"scrollbar",scroll:"y",id:"scrollVer"}]},{view:"scrollbar",scroll:"x",id:"scrollHor",height:20}]},gantt.init(this.ganttContainer),this.setState({reinitialise:!1})}gantt.parse(this.props.tasks),gantt.render()}},{key:"initGanttEvents",value:function(){var t=this;gantt.ganttEventsInitialized||(gantt.ganttEventsInitialized=!0,gantt.attachEvent("onBeforeTaskDelete",function(e,n){return t.props.tasks.data.length>1||(w.a.show({intent:y.a.DANGER,message:"Cannot delete last phase, there must be at least one phase defined in the model"}),!1)}),gantt.attachEvent("onAfterTaskAdd",function(e,n){t.props.onTaskUpdated&&t.props.onTaskUpdated(e,"inserted",n,t.props.scenarioId)}),gantt.attachEvent("onAfterTaskUpdate",function(e,n){t.props.onTaskUpdated&&t.props.onTaskUpdated(e,"updated",n,t.props.scenarioId)}),gantt.attachEvent("onAfterTaskDelete",function(e){t.props.onTaskUpdated&&t.props.onTaskUpdated(e,"deleted",t.props.scenarioId)}),gantt.attachEvent("onAfterLinkAdd",function(e,n){t.props.onLinkUpdated&&t.props.onLinkUpdated(e,"inserted",n)}),gantt.attachEvent("onAfterLinkUpdate",function(e,n){t.props.onLinkUpdated&&t.props.onLinkUpdated(e,"updated",n)}),gantt.attachEvent("onAfterLinkDelete",function(e,n){t.props.onLinkUpdated&&t.props.onLinkUpdated(e,"deleted")}))}},{key:"componentDidMount",value:function(){var t=this;this.initGanttEvents(),gantt.config.show_progress=!1;var e=this.props.dark?"gantt_container darkGantt":"gantt_container";gantt.config.layout={css:e,rows:[{cols:[{view:"grid",id:"grid",scrollX:"scrollHor",scrollY:"scrollVer"},{view:"timeline",id:"timeline",scrollX:"scrollHor",scrollY:"scrollVer"},{view:"scrollbar",scroll:"y",id:"scrollVer"}]},{view:"scrollbar",scroll:"x",id:"scrollHor",height:20}]},gantt.config.task_height=12,gantt.config.row_height=24,gantt.templates.grid_header_class=function(){return t.props.dark?"darkGantt":""},gantt.templates.grid_row_class=function(){return t.props.dark?"darkGantt":""},gantt.templates.task_row_class=function(){return t.props.dark?"darkGantt":""},gantt.templates.task_cell_class=function(){return t.props.dark?"darkGantt":""},gantt.templates.scale_row_class=function(){return t.props.dark?"darkGantt":""},gantt.templates.task_text=function(){return""},gantt.templates.grid_file=function(){return'<span style="margin-right: 10px;" icon="gantt-chart" class="bp3-icon bp3-icon-gantt-chart"><svg data-icon="gantt-chart" width="16" height="16" viewBox="0 0 16 16"><desc>gantt-chart</desc><path d="M10 10c0 .55.45 1 1 1h4c.55 0 1-.45 1-1s-.45-1-1-1h-4c-.55 0-1 .45-1 1zM6 7c0 .55.45 1 1 1h4c.55 0 1-.45 1-1s-.45-1-1-1H7c-.55 0-1 .45-1 1zm9 5H2V3c0-.55-.45-1-1-1s-1 .45-1 1v10c0 .55.45 1 1 1h14c.55 0 1-.45 1-1s-.45-1-1-1zM4 5h3c.55 0 1-.45 1-1s-.45-1-1-1H4c-.55 0-1 .45-1 1s.45 1 1 1z" fill-rule="evenodd"></path></svg></span>'},gantt.config.duration_unit="week",gantt.init(this.ganttContainer),gantt.parse(this.props.tasks)}},{key:"render",value:function(){var t=this;return this.setZoom(this.props.zoom),d.a.createElement("div",{ref:function(e){t.ganttContainer=e},style:{width:"100%",height:this.props.size.height}})}}],[{key:"getDerivedStateFromProps",value:function(t,e){return t.dark!==e.dark?{dark:t.dark,reinitialise:!0}:null}}]),e}(l.Component)),U=Object(u.b)(function(t,e){return{dark:t.editor.dark,tasks:k(t,e.scenarioId)}})(E),C=n(108),O=n(74),j=n(384),S=function(t){function e(t){var n;return Object(a.a)(this,e),(n=Object(i.a)(this,Object(o.a)(e).call(this,t))).handleZoomChange=n.handleZoomChange.bind(Object(s.a)(n)),n}return Object(c.a)(e,t),Object(r.a)(e,[{key:"handleZoomChange",value:function(t){this.props.onZoomChange&&this.props.onZoomChange(t)}},{key:"render",value:function(){var t=this;return d.a.createElement(C.a,{style:{marginLeft:10,marginRight:10}},d.a.createElement(C.a,null,["Weeks","Months","Quarters","Years"].map(function(e,n,a){var r=t.props.zoom===e,i=n<a.indexOf(t.props.zoom)?"zoom-out":"zoom-in";return d.a.createElement(O.b,{key:e,value:e,active:r,onClick:function(){return t.handleZoomChange(e)},text:e,icon:!r&&i})})),d.a.createElement(j.a,{active:this.props.activeScenario,handleChange:this.props.handleChangeScenario}))}}]),e}(l.Component),T=n(378),x=function(t){function e(t){var n;return Object(a.a)(this,e),(n=Object(i.a)(this,Object(o.a)(e).call(this,t))).state={currentZoom:"Quarters",messages:[],activeScenario:t.initialScenario},n.handleZoomChange=n.handleZoomChange.bind(Object(s.a)(n)),n.logTaskUpdate=n.logTaskUpdate.bind(Object(s.a)(n)),n.logLinkUpdate=n.logLinkUpdate.bind(Object(s.a)(n)),n}return Object(c.a)(e,t),Object(r.a)(e,[{key:"addMessage",value:function(t){var e=this.state.messages.slice(),n=e.length?e[0].key:0;e.unshift({key:n+1,message:t}),e.length>40&&e.pop(),this.setState({messages:e})}},{key:"logTaskUpdate",value:function(t,e,n){var a=n&&n.text?" (".concat(n.text,")"):"",r="Task ".concat(e,": ").concat(t," ").concat(a);this.addMessage(r)}},{key:"logLinkUpdate",value:function(t,e,n){var a="Link ".concat(e,": ").concat(t);n&&(a+=" ( source: ".concat(n.source,", target: ").concat(n.target," )")),this.addMessage(a)}},{key:"handleZoomChange",value:function(t){this.setState({currentZoom:t})}},{key:"render",value:function(){var t=this;return d.a.createElement("div",{style:{display:"flex",flexDirection:"column",padding:10,height:"100%"}},d.a.createElement(S,{onZoomChange:this.handleZoomChange,zoom:this.state.currentZoom,activeScenario:this.state.activeScenario,handleChangeScenario:function(e){return t.setState({activeScenario:e})}}),d.a.createElement(g.SizeMe,{monitorHeight:!0},function(e){var n=e.size;return d.a.createElement("div",{style:{flex:1,flexDirection:"column",marginTop:10,height:"100%",overflow:"hidden",backgroundColor:"#30404d"}},d.a.createElement(U,{zoom:t.state.currentZoom,onTaskUpdated:t.props.handleTaskUpdate,onLinkUpdated:t.props.handleLinkUpdate,size:n,scenarioId:t.state.activeScenario.id}))}))}}]),e}(l.Component),L=Object(u.b)(function(t){return{initialScenario:t.model.programmes[0].scenarios[0]}},function(t){return{handleTaskUpdate:function(e,n,a,r){t(function(t,e,n,a){var r=f.cc;switch(e){case"updated":var i={name:n.text,duration:n.duration,start:h()(n.start_date).format(f.V)};return function(e,n){var r=n(),o=Object(b.A)(r.model,a).phaseSensitivity.map(function(e){return e.id===t?Object(v.a)({},e,{duration:i.duration,start:i.start}):e});e({type:_.s,id:a,typeKey:"phaseSensitivity",values:o})};case"deleted":return{type:_.c,id:t,key:r};case"inserted":var o={name:n.text,duration:n.duration,start:h()(n.start_date).format(f.V),slip:f.jc};return{type:_.a,key:r,element:o};default:throw new Error("Unrecognised gantt update mode")}}(e,n,a,r))},handleLinkUpdate:function(e,n,a){switch(n){case"inserted":return t(Object(T.b)(e,Number.parseInt(a.type),a.source,a.target));case"deleted":return t(Object(T.d)(e));default:throw new Error("Unknown link update mode")}}}})(x);e.default=L}}]);
//# sourceMappingURL=5.4fc5ca61.chunk.js.map